<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Inscrição Jogos Escolares</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f7f7f7;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0px 4px 10px rgba(0,0,0,0.1);
    }
    h2 {
      text-align: center;
    }
    label {
      font-weight: bold;
      margin-top: 10px;
      display: block;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      border-radius: 6px;
      border: 1px solid #ccc;
      box-sizing: border-box;
    }
    .aluno {
      border: 1px solid #ddd;
      padding: 15px;
      margin-top: 15px;
      border-radius: 10px;
      background: #fafafa;
    }
    button {
      margin-top: 15px;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      background: #4CAF50;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background: #45a049;
    }
    @media (max-width: 600px) {
      .container {
        padding: 10px;
      }
      input, select {
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Formulário de Inscrição</h2>

    <label>Unidade de Ensino:</label>
    <input type="text" id="unidadeEnsino" required>

    <label>Nome do Professor Responsável:</label>
    <input type="text" id="professor" required>

    <label>Email de Contato:</label>
    <input type="email" id="email" required>

    <label>Telefone:</label>
    <input type="tel" id="telefone" required>

    <div id="alunosContainer"></div>

    <button type="button" onclick="adicionarAluno()">+ Adicionar Aluno</button>
    <button type="button" onclick="enviarFormulario()">Enviar Inscrição</button>
  </div>

  <script>
    const provasPorCategoria = {
      "Mirim": ["50m", "100m", "Salto em distância", "Arremesso de peso"],
      "Infantil": ["100m", "200m", "400m", "Salto em altura", "Lançamento de dardo"],
      "Infanto": ["400m", "800m", "1500m", "Salto triplo", "Arremesso de disco"]
    };

    const revezamentos = ["4x100m", "4x400m"];

    let alunoCount = 0;

    function adicionarAluno() {
      alunoCount++;
      const container = document.getElementById("alunosContainer");

      const div = document.createElement("div");
      div.classList.add("aluno");
      div.innerHTML = `
        <h3>Aluno ${alunoCount}</h3>
        <label>Nome:</label>
        <input type="text" class="nome" required>

        <label>Gênero:</label>
        <select class="genero" required>
          <option value="">Selecione</option>
          <option value="Masculino">Masculino</option>
          <option value="Feminino">Feminino</option>
        </select>

        <label>Data de Nascimento:</label>
        <input type="text" class="dataNascimento" placeholder="DD/MM/AAAA" required>

        <label>Categoria:</label>
        <select class="categoria" onchange="atualizarProvas(this)" required>
          <option value="">Selecione</option>
          <option value="Mirim">Mirim</option>
          <option value="Infantil">Infantil</option>
          <option value="Infanto">Infanto</option>
        </select>

        <label>Prova 1:</label>
        <select class="prova1" onchange="filtrarProvas(this)">
          <option value="">Selecione</option>
        </select>

        <label>Prova 2:</label>
        <select class="prova2">
          <option value="">Selecione</option>
        </select>

        <label>Revezamento:</label>
        <select class="revezamento">
          <option value="">Selecione</option>
          ${revezamentos.map(p => `<option value="${p}">${p}</option>`).join("")}
        </select>
      `;
      container.appendChild(div);
    }

    function atualizarProvas(selectCategoria) {
      const categoria = selectCategoria.value;
      const divAluno = selectCategoria.closest(".aluno");
      const prova1 = divAluno.querySelector(".prova1");
      const prova2 = divAluno.querySelector(".prova2");

      prova1.innerHTML = `<option value="">Selecione</option>`;
      prova2.innerHTML = `<option value="">Selecione</option>`;

      if (categoria && provasPorCategoria[categoria]) {
        provasPorCategoria[categoria].forEach(p => {
          prova1.innerHTML += `<option value="${p}">${p}</option>`;
          prova2.innerHTML += `<option value="${p}">${p}</option>`;
        });
      }
    }

    function filtrarProvas(select) {
      const divAluno = select.closest(".aluno");
      const prova1 = divAluno.querySelector(".prova1").value;
      const prova2 = divAluno.querySelector(".prova2");

      const categoria = divAluno.querySelector(".categoria").value;
      prova2.innerHTML = `<option value="">Selecione</option>`;
      if (categoria && provasPorCategoria[categoria]) {
        provasPorCategoria[categoria].forEach(p => {
          if (p !== prova1) {
            prova2.innerHTML += `<option value="${p}">${p}</option>`;
          }
        });
      }
    }

    async function enviarFormulario() {
      const unidadeEnsino = document.getElementById("unidadeEnsino").value;
      const professor = document.getElementById("professor").value;
      const email = document.getElementById("email").value;
      const telefone = document.getElementById("telefone").value;

      const alunos = [];
      document.querySelectorAll(".aluno").forEach(div => {
        const nome = div.querySelector(".nome").value;
        const genero = div.querySelector(".genero").value;
        const dataNascimento = div.querySelector(".dataNascimento").value;
        const categoria = div.querySelector(".categoria").value;
        const prova1 = div.querySelector(".prova1").value;
        const prova2 = div.querySelector(".prova2").value;
        const revezamento = div.querySelector(".revezamento").value;

        if (!prova1 && !prova2 && !revezamento) {
          alert(`O aluno ${nome} precisa estar inscrito em pelo menos uma prova.`);
          return;
        }

        alunos.push({ nome, genero, dataNascimento, categoria, prova1, prova2, revezamento });
      });

      if (alunos.length === 0) {
        alert("Inclua pelo menos um aluno!");
        return;
      }

      const data = { unidadeEnsino, professor, email, telefone, alunos };

      try {
        const response = await fetch("https://script.google.com/macros/s/AKfycbyO1MQ9xgPxOzZBO0MMC-PPgiuAhDty9FU3bUWqyJ8YH-b2TL2fplFFHBAs_Xhs3aa9zA/exec", {
          method: "POST",
          mode: "no-cors",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(data)
        });

        alert("Inscrição enviada com sucesso!");
      } catch (error) {
        alert("Erro ao enviar inscrição: " + error.message);
      }
    }
  </script>
</body>
</html>
